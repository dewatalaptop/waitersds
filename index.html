<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Alokasi Peralatan Reservasi Restoran</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background-color: #f9f9f9; }
    h2 { color: #333; }
    label, input, select { margin: 5px 0; display: block; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; }
    th, td { border: 1px solid #999; padding: 8px; text-align: left; }
    th { background-color: #eee; }
    .note { font-size: 0.9em; color: #666; }
  </style>
</head>
<body>

<h2>Formulir Reservasi Restoran</h2>

<form id="reservationForm">
  <label>Nama:</label>
  <input type="text" id="nama" required>

  <label>Tanggal Reservasi:</label>
  <input type="date" id="tanggal" required>

  <label>Waktu Mulai (jam:menit):</label>
  <input type="time" id="waktuMulai" required>

  <label>Jumlah Orang:</label>
  <input type="number" id="jumlahOrang" required min="1">

  <button type="submit">Ajukan Reservasi</button>
</form>

<h2>Alokasi Peralatan</h2>
<table id="tabelAlokasi">
  <thead>
    <tr>
      <th>Nama</th>
      <th>Tanggal</th>
      <th>Waktu</th>
      <th>Jumlah Orang</th>
      <th>Alokasi Alat</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
  const reservations = [];

  const stokAwal = {
    lauk: [
      { nama: "Roll top kotak kecil", kapasitas: 20, stok: 5 },
      { nama: "Roll top sedang", kapasitas: 45, stok: 2 },
      { nama: "Roll top bulat", kapasitas: 30, stok: 3 },
      { nama: "Roll top panjang", kapasitas: 80, stok: 2 }
    ],
    nasi: [
      { nama: "Magicom kecil", kapasitas: 20, stok: 1 },
      { nama: "Magicom besar", kapasitas: 80, stok: 3 }
    ],
    sup: [
      { nama: "Pemanas sup sedang", kapasitas: 50, stok: 2 },
      { nama: "Pemanas sup besar", kapasitas: 80, stok: 1 }
    ],
    es: [
      { nama: "Tempat es kecil", kapasitas: 20, stok: 2 },
      { nama: "Tempat es sedang", kapasitas: 40, stok: 1 },
      { nama: "Tempat es besar", kapasitas: 100, stok: 5 }
    ],
    teh: [
      { nama: "Dispenser teh kecil", kapasitas: 32, stok: 5 },
      { nama: "Dispenser teh sedang", kapasitas: 55, stok: 1 },
      { nama: "Dispenser teh besar", kapasitas: 166, stok: 1 },
      { nama: "Dispenser teh dobel", kapasitas: 100, stok: 1 }
    ]
  };

  const form = document.getElementById("reservationForm");
  const tabel = document.querySelector("#tabelAlokasi tbody");

  function cloneStok(stok) {
    return JSON.parse(JSON.stringify(stok));
  }

  function hitungAlokasi(kategori, jumlah, stok) {
    let kebutuhan = jumlah;
    const hasil = [];

    stok.sort((a, b) => b.kapasitas - a.kapasitas);

    for (const alat of stok) {
      if (kebutuhan <= 0) break;
      const maxUnit = Math.min(alat.stok, Math.ceil(kebutuhan / alat.kapasitas));
      if (maxUnit > 0) {
        hasil.push({ nama: alat.nama, jumlah: maxUnit });
        kebutuhan -= maxUnit * alat.kapasitas;
        alat.stok -= maxUnit;
      }
    }

    if (kebutuhan > 0) {
      hasil.push({ nama: `SW (${kategori})`, jumlah: Math.ceil(kebutuhan / stok[0].kapasitas) });
    }

    return hasil;
  }

  function updateTable() {
    tabel.innerHTML = "";
    const stokHarian = cloneStok(stokAwal);

    for (const res of reservations) {
      const row = document.createElement("tr");
      row.innerHTML = `
        <td>${res.nama}</td>
        <td>${res.tanggal}</td>
        <td>${res.waktuMulai}</td>
        <td>${res.jumlahOrang}</td>
        <td>${res.alokasi.map(a =>
          `<strong>${a.kategori}</strong>: ${a.alat.map(b =>
            `${b.jumlah} x ${b.nama}`
          ).join(", ")}`
        ).join("<br>")}</td>
      `;
      tabel.appendChild(row);
    }
  }

  form.addEventListener("submit", (e) => {
    e.preventDefault();

    const nama = document.getElementById("nama").value;
    const tanggal = document.getElementById("tanggal").value;
    const waktuMulai = document.getElementById("waktuMulai").value;
    const jumlahOrang = parseInt(document.getElementById("jumlahOrang").value);

    const stokHariIni = cloneStok(stokAwal);

    const alokasi = [];

    for (const kategori in stokHariIni) {
      const alat = hitungAlokasi(kategori, jumlahOrang, stokHariIni[kategori]);
      alokasi.push({ kategori, alat });
    }

    reservations.push({
      nama,
      tanggal,
      waktuMulai,
      jumlahOrang,
      alokasi
    });

    updateTable();
    form.reset();
  });
</script>

</body>
</html>